SELECT 1
USE SYSUSER INDEX SYSUSER
SELECT 2
USE BCCTAS INDEX BCCTAS
SELECT 3
USE BCOPECTA INDEX BCOPECTA
STORE WUSERCODE TO WOPERADOR
STORE .T. TO WCARGANDO
DO WHILE WCARGANDO
   @ 4,0 CLEAR to 9,55
   @ 5,0 TO 09,55
   @ 04,00 SAY "OPERADORES POR CUENTA BANCARIA"
   @ 06,2 SAY "OPERADOR:"
   @ 08,2 SAY "CUENTA  :"
   @ 06,12 GET WOPERADOR
   READ
   IF WOPERADOR = SPACE(8) .OR.READKEY()=12.OR.READKEY()=268
      EXIT
   ENDIF
   SELECT 1
   SEEK WOPERADOR
   IF .NOT.FOUND()
      STORE "OPERADOR NO REGISTRADO EN EL SISTEMA, VERIFIQUE." TO MES
      DO AVISO WITH MES
      LOOP
   ELSE
      STORE USERNOM  TO WUSERNAME
   ENDIF
   @ 06,25 SAY WUSERNAME
   @ 08,12 GET WCUENTA
   READ
   IF WCUENTA = SPACE(4) .OR.READKEY()=12.OR.READKEY()=268
      EXIT
   ENDIF
   SELECT 2
   SEEK WCUENTA
   IF .NOT.FOUND()
      STORE "CUENTA BANCARIA NO REGISTRADA EN EL SISTEMA, VERIFIQUE." TO MES
      DO AVISO WITH MES
      LOOP
   ELSE
      STORE DESCRI TO WCTANAME
   ENDIF
   @ 08,25 say wctaname
   STORE WOPERADOR+WCUENTA TO WCLAVE
   SELECT 3
   SEEK WCLAVE
   IF .NOT.FOUND()
      STORE .T. TO WINGRESA
      STORE .T. TO WMODIFICA
      STORE "ACCESO NO REGISTRADO, INGRESAR ? (S/N)" TO TEX
      STORE "SN" TO WCH
      DO PREGUNTA
      IF WCH = "N"
         LOOP
      ENDIF
   ELSE
      STORE .F. TO WINGRESA
      STORE .F. TO WMODIFICA
   ENDIF
   IF .NOT. WMODIFICA
      STORE "OPCIONES: (E)LIMINAR, (S)ALIR" TO TEX
      STORE "SE" TO WCH
      DO PREGUNTA
      STORE WCH TO WRESP
      IF WRESP= "S"
         LOOP
      ELSE
         IF WRESP= "E"
            STORE "ESTA SEGURO QUE DESEA ELIMINAR ? (S/N)" TO TEX
            STORE "NS" TO WCH
            DO PREGUNTA
            IF WCH = "N"
               LOOP
            ELSE
                SELECT 3
                DO RECLOC
                DELETE
                UNLOCK
                LOOP
            ENDIF
         ENDIF
      ENDIF
   ENDIF
   IF WINGRESA
      SELECT 3
      DO FILLOC
      APPEND BLANK
      UNLOCK
      DO RECLOC
      REPLACE OPERADOR  WITH WOPERADOR
      REPLACE CTA       WITH WCUENTA
   ENDIF
   FLUSH
   UNLOCK
ENDDO
CLOSE DATA
CLOSE INDEX
RETURN
