SELECT 1
USE BCBANCOS INDEX BCBANCOS
SELECT 2
USE BCCTAS   INDEX BCCTAS2
SELECT 3
USE BCOPERA INDEX BCOPERA2
SELECT 4
USE BCBENEFI INDEX BCBENEF1

SAVE SCRE TO WSCRE99
STORE SPACE(4)      TO XCODBCO
STORE SPACE(20)     TO XNUMCTA
STORE 0             TO XNUMCHN
STORE 0 TO WCLAVE1
STORE 0 TO WCLAVE2
STORE 0 TO WCLAVE3
store .t. to viendo
do while viendo
   RESTORE SCRE FROM WSCRE99
   SET COLOR TO
   @ 04,0 clear to 15,79
   @ 05,0 to 15,79
   @ 04,0 SAY " CONFORMAR CHEQUES "
   @ 06,1 say "CODIGO BANCO:"
   @ 07,1 say "No.DE CUENTA:"
   @ 08,1 say "No.DE CHEQUE:"
   @ 09,1 say "MONTO       :"
   @ 10,1 say "BENEFICIARIO:"
   @ 11,1 say "CLAVE No. 1 :"
   @ 12,1 say "CLAVE No. 2 :"
   @ 13,1 say "CLAVE No. 3 :"
   @ 14,1 say "CONFORMACION:"
   @ 06,14 GET XCODBCO
   READ
   IF XCODBCO=SPACE(4).OR.READKEY()=12 .OR. READKEY()=268
      EXIT
   ENDIF
   SELECT 1
   FIND &XCODBCO
   IF EOF()
      STORE "CODIGO DE BANCO NO REGISTRADO, VERIFIQUE" TO MES
      DO AVISO WITH MES
      LOOP
   ENDIF
   @ 06,40 SAY DESCRI

   @ 07,14 GET XNUMCTA
   READ
   IF XNUMCTA=SPACE(20).OR.READKEY()=12 .OR. READKEY()=268
      LOOP
   ENDIF
   STORE XCODBCO+XNUMCTA TO WCLAVECTA
   SELECT 2
   FIND &WCLAVECTA
   IF EOF()
      STORE "NUMERO DE CUENTA NO REGISTRADO PARA ESTE BANCO, VERIFIQUE" TO MES
      DO AVISO WITH MES
      LOOP
   ENDIF
   @ 07,40 SAY DESCRI
   STORE CTA TO WCODCTA

   @ 08,14 GET XNUMCHN PICTURE "############"
   READ
   IF XNUMCHN=0.OR.READKEY()=12 .OR. READKEY()=268
      LOOP
   ENDIF
   STORE XNUMCHN   TO WNUMBERN
   STORE SPACE(12) TO WNUMBERC
   DO STRNUMBER
   STORE WNUMBERC  TO XNUMCHC
   @ 08,14 SAY XNUMCHC

   STORE WCODCTA+"CH"+XNUMCHC TO WCLAVECH
   SELECT 3
   FIND &WCLAVECH
   IF EOF()
      STORE "NUMERO DE CHEQUE NO REGISTRADO PARA ESTA CUENTA, VERIFIQUE" TO MES
      DO AVISO WITH MES
      LOOP
   ENDIF
   @ 08,40 SAY DESCRI
   @ 09,14 SAY MONTO PICTURE "####,###,###.##"

   STORE BENEFI TO WBENEFI
   SELECT 4
   FIND &WBENEFI
   IF EOF()
      STORE "NO REGISTRADO" TO WBENDES
   ELSE
      STORE DESCRI          TO WBENDES
   ENDIF

   SELECT 3
   @ 10,14 SAY WBENDES
   @ 11,14 GET WCLAVE1 PICTURE "############"
   @ 12,14 GET WCLAVE2 PICTURE "############"
   @ 13,14 GET WCLAVE3 PICTURE "############"
   READ
   IF CLAVE1<>WCLAVE1.OR.CLAVE2<>WCLAVE2.OR.CLAVE3<>WCLAVE3
      STORE "ERROR EN CLAVES DE CONFORMACION" TO MES
      DO AVISO WITH MES
      LOOP
   ELSE
      IF CONFORMADO > 0
         STORE "ADVERTENCIA: ESTE CHEQUE YA ESTABA CONFORMADO" TO MES
         DO AVISO WITH MES
         LOOP
      ENDIF
      *** CALCULA CLAVE DE CONFORMACION
      STORE (CLAVE1+CLAVE2)-CLAVE3 TO WCONFORME
      @ 14,14 SAY WCONFORME PICTURE "############"
      STORE "CLAVES CORRECTAS, COPIAR CLAVE DE CONFORMACION EN CHEQUE" TO MES
      DO AVISO WITH MES
      SELECT 3
      DO RECLOC
      REPLACE CONFORMADO WITH WCONFORME
   ENDIF
ENDDO
close data
close index
return



