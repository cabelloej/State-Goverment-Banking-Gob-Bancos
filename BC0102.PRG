SELECT 1
USE BCBANCOS INDEX BCBANCOS
SELECT 2
USE BCSUCUR  INDEX BCSUCUR
STORE .T. TO WCARGANDO
DO WHILE WCARGANDO
   @ 4,0 CLEAR to 09,55
   @ 5,0 TO 09,55
   @ 04,00 SAY "SUCURSALES POR BANCO"
   @ 06,02 SAY "BANCO   :"
   @ 08,02 SAY "SUCURSAL:"
   @ 06,12 GET WBANCO
   READ
   IF WBANCO = SPACE(4) .OR.READKEY()=12.OR.READKEY()=268
      EXIT
   ENDIF
   SELECT 1
   FIND &WBANCO
   IF EOF()
      STORE "BANCO NO REGISTRADO, VERIFIQUE." TO MES
      DO AVISO WITH MES
      LOOP
   ELSE
      @ 06,20 SAY DESCRI
   ENDIF

   @ 08,12 GET WSUCURSAL
   READ
   IF WSUCURSAL = SPACE(4) .OR.READKEY()=12.OR.READKEY()=268
      EXIT
   ENDIF
   SELECT 2
   STORE WBANCO+WSUCURSAL TO WCLAVE
   FIND &WCLAVE
   IF EOF()
      STORE .T. TO WINGRESA
      STORE .T. TO WMODIFICA
      STORE "SUCURSAL NO REGISTRADA PARA ESTE BANCO, INGRESAR ? (S/N)" TO TEX
      STORE "SN" TO WCH
      DO PREGUNTA
      IF WCH = "N"
         LOOP
      ENDIF
      STORE SPACE(30)        TO WDESCRI
   ELSE
      STORE .F. TO WINGRESA
      STORE .F. TO WMODIFICA
      STORE DESCRI           TO WDESCRI
   ENDIF
   @ 8, 20 SAY WDESCRI
   IF .NOT. WMODIFICA
      STORE "OPCIONES: (M)ODIFICAR, (E)LIMINAR, (S)ALIR" TO TEX
      STORE "SME" TO WCH
      DO PREGUNTA
      STORE WCH TO WRESP
      IF WRESP= "S"
         LOOP
      ELSE
         IF WRESP= "M"
            STORE .T. TO WMODIFICA
         ELSE
            STORE "ESTA SEGURO QUE DESEA ELIMINAR ? (S/N)" TO TEX
            STORE "NS" TO WCH
            DO PREGUNTA
            IF WCH = "N"
               LOOP
            ELSE
               *** CHEQUEAR QUE LA SUCURSAL DEL BANCO ESTE SIN CONEXIONES EN BCOPERAC.DBF
                 SELECT 2
                 DELETE
                 LOOP
            ENDIF
         ENDIF
      ENDIF
   ENDIF

   IF WMODIFICA
      *** DESCRIPCION
      STORE .T. TO WACT
      DO WHILE WACT
         STORE "INGRESE EL NOMBRE DE LA SUCURSAL" TO MES
         DO MENSAJE WITH MES
         @ 8,20 GET WDESCRI
         READ
         IF READKEY()=12.OR.READKEY()=268
            STORE .F. TO WCARGANDO
            EXIT
         ENDIF
         IF WDESCRI <> SPACE(30)
            EXIT
         ENDIF
      ENDDO
      IF .NOT. WCARGANDO
         EXIT
      ENDIF
   ENDIF
   STORE "CONFORME ? (S/N)" TO TEX
   STORE "SN" TO WCH
   DO PREGUNTA
   IF WCH = "N"
      LOOP
   ENDIF
   IF WINGRESA
      SELECT 2
      DO FILLOC
      APPEND BLANK
      UNLOCK
      DO RECLOC
      REPLACE BANCO  WITH WBANCO
      REPLACE SUCURSAL  WITH WSUCURSAL
   ENDIF
   DO RECLOC
   REPLACE DESCRI   WITH WDESCRI
   FLUSH
   UNLOCK
ENDDO
CLOSE DATA
CLOSE INDEX
RETURN

